{"version":3,"sources":["file:///Users/zhao/Desktop/test/cocos-creator/HitCube/assets/Scripts/AttackController.ts"],"names":["_decorator","Component","Prefab","input","Input","instantiate","RigidBody","Vec3","ccclass","property","AttackController","isTouching","fireTimer","start","on","EventType","TOUCH_START","onTouchStart","TOUCH_END","onTouchEnd","onDestroy","off","update","deltaTime","fireRate","fire","bullte","bulletPrefab","setParent","node","setWorldPosition","position","rgd","getComponent","setLinearVelocity","bulletSpeed","event"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,U,OAAAA,U;AAAYC,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,K,OAAAA,K;AAAmBC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;;;;;;;;;OAC1F;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBT,U;;kCAGjBU,gB,WADZF,OAAO,CAAC,kBAAD,C,UAGHC,QAAQ,CAACP,MAAD,C,2BAHb,MACaQ,gBADb,SACsCT,SADtC,CACgD;AAAA;AAAA;;AAAA;;AAAA;;AAAA;;AAAA,eASpCU,UAToC,GASf,KATe;AAAA,eAUpCC,SAVoC,GAU1B,CAV0B;AAAA;;AAY5CC,QAAAA,KAAK,GAAG;AACJV,UAAAA,KAAK,CAACW,EAAN,CAASV,KAAK,CAACW,SAAN,CAAgBC,WAAzB,EAAsC,KAAKC,YAA3C,EAAyD,IAAzD;AACAd,UAAAA,KAAK,CAACW,EAAN,CAASV,KAAK,CAACW,SAAN,CAAgBG,SAAzB,EAAoC,KAAKC,UAAzC,EAAqD,IAArD;AACH;;AAESC,QAAAA,SAAS,GAAS;AACxBjB,UAAAA,KAAK,CAACkB,GAAN,CAAUjB,KAAK,CAACW,SAAN,CAAgBC,WAA1B,EAAuC,KAAKC,YAA5C,EAA0D,IAA1D;AACAd,UAAAA,KAAK,CAACkB,GAAN,CAAUjB,KAAK,CAACW,SAAN,CAAgBG,SAA1B,EAAqC,KAAKC,UAA1C,EAAsD,IAAtD;AACH;;AAEDG,QAAAA,MAAM,CAACC,SAAD,EAAoB;AACtB,cAAI,CAAC,KAAKZ,UAAV,EAAsB;AACtB,eAAKC,SAAL,IAAkBW,SAAlB;AACA,cAAG,KAAKX,SAAL,IAAkB,KAAKY,QAA1B,EAAoC;AACpC,eAAKC,IAAL;AACA,eAAKb,SAAL,GAAiB,CAAjB;AACH;;AAEDa,QAAAA,IAAI,GAAG;AACH,cAAMC,MAAM,GAAGrB,WAAW,CAAC,KAAKsB,YAAN,CAA1B;AACAD,UAAAA,MAAM,CAACE,SAAP,CAAiB,KAAKC,IAAtB;AACAH,UAAAA,MAAM,CAACI,gBAAP,CAAwB,KAAKD,IAAL,CAAUE,QAAlC;AACA,cAAMC,GAAG,GAAGN,MAAM,CAACO,YAAP,CAAoB3B,SAApB,CAAZ;AACA0B,UAAAA,GAAG,CAACE,iBAAJ,CAAsB,IAAI3B,IAAJ,CAAS,CAAT,EAAY,CAAZ,EAAe,CAAC,KAAK4B,WAArB,CAAtB;AACH;;AAEOlB,QAAAA,YAAY,CAACmB,KAAD,EAAoB;AACpC,eAAKzB,UAAL,GAAkB,IAAlB;AACH;;AAEOQ,QAAAA,UAAU,CAACiB,KAAD,EAAoB;AAClC,eAAKzB,UAAL,GAAkB,KAAlB;AACH;;AA5C2C,O;;;;;iBAGd,I;;mFAC7BF,Q;;;;;iBACwB,G;;sFACxBA,Q;;;;;iBAC2B,E","sourcesContent":["import { _decorator, Component, Node, Prefab, input, Input, EventTouch, instantiate, RigidBody, Vec3 } from 'cc';\nconst { ccclass, property } = _decorator;\n\n@ccclass('AttackController')\nexport class AttackController extends Component {\n\n    @property(Prefab)\n    public bulletPrefab: Prefab = null\n    @property\n    public fireRate:number = 0.3;\n    @property\n    public bulletSpeed:number = 40;\n\n    private isTouching:boolean = false;\n    private fireTimer=0;\n\n    start() {\n        input.on(Input.EventType.TOUCH_START, this.onTouchStart, this);\n        input.on(Input.EventType.TOUCH_END, this.onTouchEnd, this)\n    }\n\n    protected onDestroy(): void {\n        input.off(Input.EventType.TOUCH_START, this.onTouchStart, this);\n        input.off(Input.EventType.TOUCH_END, this.onTouchEnd, this)\n    }\n\n    update(deltaTime: number) {\n        if (!this.isTouching) return\n        this.fireTimer += deltaTime\n        if(this.fireTimer <= this.fireRate) return\n        this.fire()\n        this.fireTimer = 0\n    }\n\n    fire() {\n        const bullte = instantiate(this.bulletPrefab)\n        bullte.setParent(this.node)\n        bullte.setWorldPosition(this.node.position)\n        const rgd = bullte.getComponent(RigidBody)\n        rgd.setLinearVelocity(new Vec3(0, 0, -this.bulletSpeed))\n    }\n\n    private onTouchStart(event: EventTouch) {\n        this.isTouching = true\n    }\n\n    private onTouchEnd(event: EventTouch) {\n        this.isTouching = false\n    }\n\n}\n\n"]}